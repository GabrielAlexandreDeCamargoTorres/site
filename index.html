<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Jogo de Luta</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #121212;
      font-family: sans-serif;
      color: white;
    }

    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: #1e1e1e;
    }

    #result {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 30px;
      color: white;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="400"></canvas>
<div id="result"></div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const redSquare = {
  x: 150,
  y: 300,
  size: 40,
  speed: 5,
  hp: 100,
  color: 'red',
  attackBox: { x: 190, y: 290, width: 20, height: 10 }, // Hitbox do ataque
  attackCooldown: 0
};

const blueSquare = {
  x: 600,
  y: 300,
  size: 40,
  speed: 3,
  hp: 100,
  color: 'blue',
  attackBox: { x: 540, y: 290, width: 20, height: 10 }, // Hitbox do ataque
  attackCooldown: 0
};

let redAttack = [];
let blueAttack = [];
let gameOver = false;

function drawSquare(x, y, size, color) {
  ctx.fillStyle = color;
  ctx.fillRect(x - size / 2, y - size / 2, size, size);
}

function drawHitbox(x, y, width, height) {
  ctx.fillStyle = 'green';
  ctx.fillRect(x, y, width, height);
}

function drawProjectile(x, y, color) {
  ctx.fillStyle = color;
  ctx.fillRect(x, y, 10, 5); // Bola de fogo (retângulo)
}

function update() {
  if (gameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Movimentação do jogador (quadrado vermelho)
  if (keys['ArrowLeft']) redSquare.x -= redSquare.speed;
  if (keys['ArrowRight']) redSquare.x += redSquare.speed;

  // Movimentação do inimigo (quadrado azul - IA simples)
  if (blueSquare.x < redSquare.x) blueSquare.x += blueSquare.speed;
  if (blueSquare.x > redSquare.x) blueSquare.x -= blueSquare.speed;

  // Desenhando os quadrados
  drawSquare(redSquare.x, redSquare.y, redSquare.size, redSquare.color);
  drawSquare(blueSquare.x, blueSquare.y, blueSquare.size, blueSquare.color);

  // Desenhando hitboxes (áreas de ataque)
  drawHitbox(redSquare.attackBox.x, redSquare.attackBox.y, redSquare.attackBox.width, redSquare.attackBox.height);
  drawHitbox(blueSquare.attackBox.x, blueSquare.attackBox.y, blueSquare.attackBox.width, blueSquare.attackBox.height);

  // Desenhando os projéteis (bolas de fogo)
  redAttack.forEach((proj, index) => {
    proj.x += 7; // velocidade da bola de fogo do vermelho
    drawProjectile(proj.x, proj.y, 'yellow');
    // Verifica se atingiu o inimigo
    if (proj.x > blueSquare.x - blueSquare.size / 2 && proj.x < blueSquare.x + blueSquare.size / 2 &&
        proj.y > blueSquare.y - blueSquare.size / 2 && proj.y < blueSquare.y + blueSquare.size / 2) {
      blueSquare.hp -= 10;
      redAttack.splice(index, 1); // Remove o projétil
    }
    // Remove se sair da tela
    if (proj.x > canvas.width) redAttack.splice(index, 1);
  });

  blueAttack.forEach((proj, index) => {
    proj.x -= 7; // velocidade da bola de fogo do azul
    drawProjectile(proj.x, proj.y, 'orange');
    // Verifica se atingiu o jogador
    if (proj.x > redSquare.x - redSquare.size / 2 && proj.x < redSquare.x + redSquare.size / 2 &&
        proj.y > redSquare.y - redSquare.size / 2 && proj.y < redSquare.y + redSquare.size / 2) {
      redSquare.hp -= 10;
      blueAttack.splice(index, 1); // Remove o projétil
    }
    // Remove se sair da tela
    if (proj.x < 0) blueAttack.splice(index, 1);
  });

  // Verifica se algum dos quadrados morreu
  if (redSquare.hp <= 0) {
    gameOver = true;
    document.getElementById('result').innerText = 'Azul venceu!';
  }

  if (blueSquare.hp <= 0) {
    gameOver = true;
    document.getElementById('result').innerText = 'Vermelho venceu!';
  }

  // Atualizando HP na tela
  ctx.fillStyle = 'white';
  ctx.font = '20px Arial';
  ctx.fillText('HP Vermelho: ' + redSquare.hp, 20, 30);
  ctx.fillText('HP Azul: ' + blueSquare.hp, canvas.width - 120, 30);
}

let keys = {};

// Controle do teclado
window.addEventListener('keydown', (e) => {
  keys[e.key] = true;
  if (e.key === 'b' && redSquare.attackCooldown <= 0) {
    redAttack.push({ x: redSquare.x + redSquare.size / 2, y: redSquare.y });
    redSquare.attackCooldown = 30; // cooldown entre os ataques
  }
});

window.addEventListener('keyup', (e) => {
  keys[e.key] = false;
});

function gameLoop() {
  if (redSquare.attackCooldown > 0) redSquare.attackCooldown--;
  if (blueSquare.attackCooldown <= 0 && Math.random() < 0.02) {
    blueAttack.push({ x: blueSquare.x - blueSquare.size / 2, y: blueSquare.y });
    blueSquare.attackCooldown = 60; // cooldown para os ataques do azul
  }
  update();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
